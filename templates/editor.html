<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architect Editor - {{ slug }}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.7/quill.snow.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='editor.css') }}">
</head>
<body>
    <div class="editor-container">
        <!-- Toolbar Gauche -->
        <aside class="toolbar">
            <div class="toolbar-header">
                <div class="toolbar-tabs">
                    <button class="tab-btn active" data-tab="add">â• Ajouter</button>
                    <button class="tab-btn" data-tab="list">ğŸ“‹ Liste</button>
                </div>
            </div>
            
            <!-- Onglet Ajouter -->
            <div class="tab-content active" id="tab-add">
                <p style="color: #666; font-size: 12px; margin-bottom: 15px;">Glissez-dÃ©posez sur le canvas</p>
                <button class="tool-btn" data-type="text" draggable="true">ğŸ“ Texte Riche</button>
                <button class="tool-btn" data-type="image" draggable="true">ğŸ–¼ï¸ Image</button>
                <button class="tool-btn" data-type="gallery" draggable="true">ğŸï¸ Galerie</button>
                <button class="tool-btn" data-type="video" draggable="true">ğŸ¬ VidÃ©o</button>
                <button class="tool-btn" data-type="youtube" draggable="true">ğŸ“º YouTube</button>
                <button class="tool-btn" data-type="shape" draggable="true">â¬› Forme</button>
                <button class="tool-btn" data-type="table" draggable="true">ğŸ“Š Tableau</button>
                <button class="tool-btn" data-type="separator" draggable="true">â– SÃ©parateur</button>
            </div>
            
            <!-- Onglet Liste -->
            <div class="tab-content" id="tab-list">
                <p style="color: #666; font-size: 12px; margin-bottom: 15px;">Cliquez pour sÃ©lectionner</p>
                <div id="components-list"></div>
            </div>
            
            <div class="toolbar-section">
                <h4>Actions</h4>
                <button id="save-btn" class="action-btn">ğŸ’¾ Sauvegarder</button>
                <button id="copy-page-btn" class="action-btn">ğŸ“‹ Copier Layout</button>
                <button id="grid-toggle" class="action-btn">ğŸ”² Grille (ON)</button>
            </div>
        </aside>

        <!-- Canvas Principal -->
        <main class="canvas-area">
            <div class="canvas-toolbar">
                <button class="back-btn" onclick="window.location.href='/'">â¬…ï¸ Retour au Dashboard</button>
                <span class="page-title">{{ slug }}</span>
                <div class="canvas-controls">
                    <div class="mode-toggle">
                        <button id="mode-normal" class="mode-btn active" title="Mode normal">ğŸ–±ï¸ Normal</button>
                        <button id="mode-move" class="mode-btn" title="Mode dÃ©placement">âœ‹ DÃ©placement</button>
                    </div>
                    <label>
                        Grille: <input type="number" id="grid-size" value="10" min="5" max="50" step="5">px
                    </label>
                    <button id="preview-btn">ğŸ‘ï¸ PrÃ©visualiser</button>
                </div>
            </div>
            <div class="canvas" id="canvas">
                <div class="canvas-inner" id="canvas-inner"></div>
            </div>
        </main>

        <!-- Panneau PropriÃ©tÃ©s Droite -->
        <aside class="properties-panel" id="properties-panel">
            <div class="properties-header">
                <h3>PropriÃ©tÃ©s</h3>
                <button id="close-props">âœ•</button>
            </div>
            <div id="properties-content">
                <p class="no-selection">SÃ©lectionnez un composant</p>
            </div>
        </aside>
    </div>

    <!-- Modale Upload Image -->
    <div class="modal" id="image-modal">
        <div class="modal-content">
            <h3>Ajouter une Image</h3>
            <input type="file" id="image-file" accept="image/*">
            <button id="upload-image-btn">Uploader</button>
            <button class="cancel-btn">Annuler</button>
        </div>
    </div>
    
    <!-- Modale Upload VidÃ©o -->
    <div class="modal" id="video-modal">
        <div class="modal-content">
            <h3>Ajouter une VidÃ©o</h3>
            <input type="file" id="video-file" accept="video/*">
            <button id="upload-video-btn">Uploader</button>
            <button class="cancel-btn">Annuler</button>
        </div>
    </div>
    
    <!-- Modale YouTube -->
    <div class="modal" id="youtube-modal">
        <div class="modal-content">
            <h3>Ajouter une VidÃ©o YouTube</h3>
            <input type="text" id="youtube-url" placeholder="URL de la vidÃ©o YouTube">
            <p style="color: #666; font-size: 12px;">Ex: https://www.youtube.com/watch?v=dQw4w9WgXcQ</p>
            <button id="add-youtube-btn">Ajouter</button>
            <button class="cancel-btn">Annuler</button>
        </div>
    </div>
    
    <!-- Modale Galerie -->
    <div class="modal" id="gallery-modal">
        <div class="modal-content">
            <h3>Ajouter des Images Ã  la Galerie</h3>
            <input type="file" id="gallery-files" accept="image/*" multiple>
            <p style="color: #666; font-size: 12px;">Vous pouvez sÃ©lectionner plusieurs images</p>
            <button id="upload-gallery-btn">Uploader</button>
            <button class="cancel-btn">Annuler</button>
        </div>
    </div>

    <!-- Modale Lien -->
    <div class="modal" id="link-modal">
        <div class="modal-content">
            <h3>Ajouter un Lien vers une Page</h3>
            <p style="color: #999; font-size: 13px; margin-bottom: 15px;">
                ğŸ’¡ SÃ©lectionnez du texte dans l'Ã©diteur, puis choisissez une page ci-dessous
            </p>
            <input type="text" id="link-url" placeholder="ğŸ” Rechercher une page par titre ou slug...">
            <div id="page-search-results"></div>
            <div style="border-top: 1px solid #444; padding-top: 15px; margin-top: 10px;">
                <p style="color: #999; font-size: 12px; margin-bottom: 10px;">Ou entrez une URL externe :</p>
                <button id="add-link-btn">Ajouter un lien externe</button>
                <button class="cancel-btn">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modale Copy Page -->
    <div class="modal" id="copy-modal">
        <div class="modal-content">
            <h3>Copier le Layout d'une Page</h3>
            <select id="source-page-select"></select>
            <button id="confirm-copy-btn">Copier</button>
            <button class="cancel-btn">Annuler</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/interactjs@1.10.19/dist/interact.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.7/quill.min.js"></script>
    <script>
        const SLUG = "{{ slug }}";
        const INITIAL_LAYOUT = {{ layout|tojson }};
    </script>
    <script src="{{ url_for('static', filename='architect.js') }}"></script>
</body>
</html>